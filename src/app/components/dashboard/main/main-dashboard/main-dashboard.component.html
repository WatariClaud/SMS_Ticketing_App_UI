<div class="main">
  <app-notifier
    [message]="notificationMessage"
    [type]="notificationType"
  ></app-notifier>

  @if(isLoading) {
  <div>
    <h4>Your data is loading, please wait. May take some time.</h4>
  </div>
  } @else { @if(!isAdmin) { @if(!isLoading && isTeller) {
  @if(current_activity?.id && !viewingPending) { } }
  <!-- Viewing Pending Activities -->
  @if(viewingPending) { @if(has_pending) { @if(pending_activities.length === 0)
  {
  <p>You have no pending activities</p>
  } @else {
  <table class="table">
    <thead>
      <tr>
        <th>Activity Id</th>
        <th>Activity code</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      @for (activity of pending_activities; track $index) {
      <tr>
        <td>{{ activity.id }}</td>
        <td>{{ activity.customer_visit }}</td>
        <td>
          @if($index === 0) {
          <button (click)="update_activity_status(activity)">Serve User</button>
          }
        </td>
      </tr>
      }
    </tbody>
  </table>
  } } @else {
  <h1>You have no pending activities</h1>
  } } @else { @if((activities_current && !isAdmin && activities_current ?.length
  === 0) || !activities_current) {
  <h1>You have no current activity</h1>
  } @else {
  <h3>You are currently serving customer:</h3>
  @for (activity of activities_current; track $index) {
  <p>Activity ID: #{{ activity.id }}</p>
  <p>Activity Code: {{ activity.customer_visit }}</p>
  <p>Consultation started at: {{ activity.created_on }}</p>
  <app-current-time [startTime]="activity.original_date"></app-current-time>
  <button (click)="cancelSession(activity)">Cancel</button>
  <button (click)="completeSession(activity)" style="margin-left: 2rem">
    Complete
  </button>
  } } } } @else {
  <div>
    @if(!isLoading) {

    <h3>Manage Users</h3>
    <table class="table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>Role</th>
        </tr>
      </thead>
      <tbody>
        @for (user of userList; track $index) {
        <tr>
          <td>{{ user.name }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.role }}</td>
        </tr>
        }
      </tbody>
    </table>
    }
  </div>
  } }
</div>
